(self.webpackChunkrestaurant=self.webpackChunkrestaurant||[]).push([[1639],{9171:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>h});var t=a(6573),r=a(7313),l=a(8467),o=a(2135),n=a(5377),c=a.n(n),i=(a(763),a(2984)),d=a.n(i),m=a(195),u=a(4423),g=a(6417);const h=()=>{const e=(0,l.s0)(),[s,a]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[h,p]=(0,r.useState)(!1),[x,j]=(0,r.useState)(null),[f,b]=(0,r.useState)({message:"",type:""}),y=(0,r.useRef)(new(c())({className:"text-danger"})),N="true"===localStorage.getItem("isloggedIn");return(0,r.useEffect)((()=>{if(x&&(b({message:x,type:"error"}),j(null)),N){const s=JSON.parse(localStorage.getItem("user"));e(s&&"user"!==s.role?"/admin/dashboard":"/")}}),[x,N,e]),(0,g.jsx)("div",{className:"container-fluid bg-white",children:(0,g.jsx)("div",{className:"signup-form-container col-lg-7 col-xl-6  mx-auto pt-5 bg-white",children:(0,g.jsxs)(m.Z,{className:"Cardimg123 bg-white",children:[f.message&&(0,g.jsx)(u.Z,{message:f.message,type:f.type,onClose:()=>{b({message:"",type:""})}}),(0,g.jsx)("form",{onSubmit:async r=>{if(r.preventDefault(),y.current.allValid()){const a=d().AES.encrypt(n,"ghjdjdgdhddjjdhgdcdghww#hsh536").toString();p(!0);try{const r=await t.Z.post("/api/login",{email:s,password:a});console.log(r);const{token:l,user:o}=r.data;document.cookie="token=".concat(l,"; path=/;"),localStorage.setItem("token",l),localStorage.setItem("user",JSON.stringify(o)),localStorage.setItem("isloggedIn",!0),sessionStorage.setItem("isloggedIn",!0),e("user"!==o.role?"/admin/dashboard":"/")}catch(c){var l,o;j((null===(l=c.response)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.message)||"Login failed")}finally{p(!1)}}else y.current.showMessages(),a(""),i("")},children:(0,g.jsxs)("div",{className:"row mx-auto p-3",children:[(0,g.jsxs)("div",{className:"col-md-12 ",children:[(0,g.jsx)("h1",{className:"text-center mt-3 fs-1 signup-form-container",children:"Login"}),(0,g.jsxs)("div",{className:"mb-3 address-container",children:[(0,g.jsxs)("p",{htmlFor:"email",className:"form-label mt-4 text-black",style:{fontWeight:"500"},children:["Email address",(0,g.jsxs)("span",{className:"text-danger",children:[" ",(0,g.jsx)("b",{children:"*"})]})]}),(0,g.jsx)("input",{value:s,style:{backgroundColor:"white",color:"black"},name:"email",onChange:e=>a(e.target.value),type:"email",required:!0,placeholder:"Email address is required",className:"form-control text-black"}),y.current.message("Email",s,"required")]})]}),(0,g.jsx)("div",{className:"col-md-12",children:(0,g.jsxs)("div",{className:"mb-3 address-container",children:[(0,g.jsxs)("p",{htmlFor:"password",className:"form-label text-black",id:"CardText",style:{fontWeight:"500"},children:["Password",(0,g.jsxs)("span",{className:"text-danger",children:[" ",(0,g.jsx)("b",{children:"*"})]})]}),(0,g.jsx)("input",{style:{backgroundColor:"white",color:"black"},value:n,name:"password",onChange:e=>i(e.target.value),type:"password",required:!0,placeholder:"Password is required",className:"form-control"}),y.current.message("password",n,"required")]})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"d-flex col-md-3  rounded mx-auto justify-content-center",children:(0,g.jsx)("button",{type:"submit",disabled:h,className:"btn my-3 px-4 btn rounded w-100 ",id:"Btn",children:"Submit"})}),(0,g.jsxs)("div",{className:"links-container row mb-4 ms-md-4 my-4",children:[(0,g.jsx)("p",{className:"col-md-4 col-12 signup-form-container",style:{fontSize:"17px"},children:(0,g.jsx)(o.rU,{to:"/",id:"CardText",style:{backgroundColor:"transparent"},children:"Go to HomePage"})}),(0,g.jsx)("p",{className:"col-md-4 col-12 signup-form-container",style:{fontSize:"17px"},children:(0,g.jsxs)(o.rU,{to:"/password/forgot",id:"CardText",style:{backgroundColor:"transparent"},children:[" ","Forgot password?"]})}),(0,g.jsx)("p",{className:"col-md-4 col-12 signup-form-container",style:{fontSize:"17px"},children:(0,g.jsx)(o.rU,{to:"/login/otp",id:"CardText",style:{backgroundColor:"transparent"},children:"Login with OTP"})})]}),(0,g.jsxs)("p",{className:"mt-4 text-black",style:{fontSize:"17px"},children:["Do not have account?",(0,g.jsx)(o.rU,{to:"/signup",className:"ms-2 signup-form-container",children:"Sign Up"})]})]})]})})]})})})}},763:()=>{},2480:()=>{}}]);